<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ACCESSIBILITY_TODO.md - Boiling Water Wiki</title>
  <link rel="stylesheet" href="/wiki/assets/styles.css" />
  <!-- Kekule CSS loaded lazily when molecule viewer is needed -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />
</head>
<body>
  <div class="wiki-layout">
    <div class="wiki-main">
      <header class="wiki-topbar">
        <details class="wiki-menu" aria-label="Menu">
          <summary>‚ò∞ Menu</summary>
          <nav class="wiki-menu-links">
            <div class="menu-section">
              <div class="menu-heading">Main</div>
              <a href="/wiki/index.html">üìö Main page</a>
            </div>
            <div class="menu-section">
              <div class="menu-heading">Science</div>
              <a href="/wiki/entities/elements/index.html">‚öõÔ∏è Elements</a>
              <a href="/wiki/entities/compounds/index.html">üß™ Compounds</a>
              <a href="/wiki/entities/solutions/index.html">üíß Solutions</a>
              <a href="/wiki/entities/phases/index.html">‚ùÑÔ∏è Phases</a>
            </div>
            <div class="menu-section">
              <div class="menu-heading">Game Structure</div>
              <a href="/wiki/entities/levels/index.html">üìä Levels</a>
              <a href="/wiki/entities/experiments/index.html">üî¨ Experiments</a>
            </div>
            <div class="menu-section">
              <div class="menu-heading">Code Reference</div>
              <a href="/wiki/entities/formulas/index.html">üìê Formulas</a>
              <a href="/wiki/entities/processes/index.html">‚öôÔ∏è Processes</a>
              <a href="/wiki/entities/modules/index.html">üì¶ Modules</a>
              <a href="/wiki/entities/symbols/index.html">üî£ Symbols</a>
              <a href="/wiki/entities/public/index.html">üìÅ Public Files</a>
              <a href="/wiki/entities/assets/index.html">üñºÔ∏è Assets</a>
            </div>
            <div class="menu-section">
              <div class="menu-heading">Repository</div>
              <a href="/wiki/entities/docs/index.html">üìñ Docs</a>
              <a href="/wiki/entities/scripts/index.html">üß∞ Scripts</a>
              <a href="/wiki/entities/styles/index.html">üé® Styles</a>
              <a href="/wiki/entities/root-files/index.html">üóÇÔ∏è Root Files</a>
              <a href="/wiki/entities/reports/changes-since-last-commit.html">üß≠ Changes</a>
            </div>
            <div class="wiki-menu-divider"></div>
            <a href="/">‚¨ÖÔ∏è Back to Game</a>
          </nav>
        </details>
        
        <nav class="breadcrumbs" aria-label="Breadcrumb">
          <a href="/wiki/../../../index.html">Main</a> <span class="breadcrumb-sep">‚Ä∫</span> <a href="/wiki/../index.html">Modules</a> <span class="breadcrumb-sep">‚Ä∫</span> <a href="/wiki/../docs/index.html">docs</a> <span class="breadcrumb-sep">‚Ä∫</span> <a href="/wiki/../docs/planning/index.html">planning</a> <span class="breadcrumb-sep">‚Ä∫</span> <span>ACCESSIBILITY_TODO.md</span>
        </nav>
        <div class="wiki-topbar-title">ACCESSIBILITY_TODO.md</div>
      </header>
      <main class="wiki-content">
        
        <article class="wiki-article">
          
      
    <aside class="infobox">
      <div class="infobox-title">ACCESSIBILITY_TODO.md</div>
      
      <div class="infobox-row">
        <div class="infobox-label">Type</div>
        <div class="infobox-value">Module</div>
      </div>
    
      <div class="infobox-row">
        <div class="infobox-label">File type</div>
        <div class="infobox-value">md</div>
      </div>
    
    </aside>
  
      <section class="section">
        
  <div class="entity-header">
    <h1>ACCESSIBILITY_TODO.md</h1>
    <p class="subtitle">Module</p>
  </div>

      </section>
      
      <section class="section" id="source-file">
        <h2>Source file</h2>
        <p><code>docs\planning\ACCESSIBILITY_TODO.md</code></p>
        <details>
          <summary>View source code</summary>
          <pre class="line-numbers"><code class="language-markdown"># Accessibility Overhaul - Detailed TODO

&gt; **Status:** PARTIALLY COMPLETE (LABELING &amp; DESCRIPTIONS ONLY)  
&gt; **Scope:** WCAG 2.1 Level AA compliance across entire React application ‚Äî **Deferred to later development stage**  
&gt; **Estimated Effort:** 40-50 hours comprehensive; 6-8 hours for quick wins  
&gt; **Priority:** DEFERRED - Revisit when core gameplay and UI are stable  
&gt; **Audit Date:** 2026-02-01

## ‚úÖ COMPLETED NOW (2026-02-01)

Limited scope: **labels, descriptions, and alt text only** (no keyboard controls, no modal/focus changes).

- Added explicit labels/IDs for location input, manual altitude input, fluid selector, and room equipment selectors.
- Added `aria-describedby` help text for key controls (timer, speed, location, equipment, setpoint).
- Added accessible error association for location errors.
- Added descriptive `alt` text for pot/flame/steam imagery.
- Added `.sr-only` utility for screen-reader-only descriptions.
- Converted room toggles to semantic buttons with `aria-pressed` and `disabled`.

---

## üìã ACCESSIBILITY AUDIT SUMMARY

**Current State:** ‚ùå **Not Accessible**
- Game scene entirely mouse/touch-dependent (no keyboard access)
- Form inputs lack label associations
- Status updates not announced to screen readers
- Color contrast insufficient in several areas
- Modal/dialog semantics missing
- Focus management non-existent

**Impact:** Users relying on keyboard navigation or screen readers cannot use the app.

---

## üî¥ PHASE 1: CRITICAL QUICK WINS (6-8 hours) ‚Äî DEFERRED

These fixes enable basic screen reader and keyboard navigation. Start here.

### 1.1 Form Input Labels
**Files:** `src/components/ControlPanel.jsx`, `src/components/RoomControls.jsx`

- [x] **Location search input** (line ~386)
  - [x] Add `&lt;label htmlFor=&quot;location-input&quot;&gt;Location/Altitude:&lt;/label&gt;`
  - [x] Add `id=&quot;location-input&quot;` to input element
  - [x] Keep placeholder as hint (label is explicit)
  
- [x] **Manual altitude input** (line ~414)
  - [x] Add `&lt;label htmlFor=&quot;altitude-input&quot;&gt;Altitude (meters):&lt;/label&gt;`
  - [x] Add `id=&quot;altitude-input&quot;` to input element
  
- [x] **Fluid/substance selector dropdown**
  - [x] Add `&lt;label htmlFor=&quot;fluid-select&quot;&gt;Fluid:&lt;/label&gt;`
  - [x] Add `id=&quot;fluid-select&quot;` to select element
  
- [x] **RoomControls selectors** (AC setpoint, air handler mode, etc.)
  - [x] Add labels for all dropdown selects
  - [x] Ensure each has matching `id` and `for` attributes

### 1.2 ARIA Live Regions for Status Updates
**Files:** `src/components/ControlPanel.jsx`, `src/components/GameScene.jsx`

- [ ] **Temperature display**
  - [ ] Defer `aria-live` updates until status messaging is finalized

- [ ] **Boiling detection alert**
  - [ ] Defer `aria-live=&quot;assertive&quot;` until messaging is finalized

- [x] **Location error messages**
  - [x] Add `aria-invalid=&quot;true&quot;` and link input to error text

- [ ] **Experiment status messages**
  - [ ] Defer `aria-live` status regions

### 1.3 Modal/Dialog Semantics
**Files:** `src/components/ControlPanel.jsx` (location popup), potential modals in GameScene

- [ ] **Location selection popup**
  - [ ] Defer semantic dialog + focus management changes
  - Example:
    ```jsx
    &lt;dialog open aria-modal=&quot;true&quot; aria-labelledby=&quot;location-title&quot;&gt;
      &lt;h2 id=&quot;location-title&quot;&gt;Select Location&lt;/h2&gt;
      {/* content */}
    &lt;/dialog&gt;
    ```

- [ ] **Scorecard modal** (when boiling completes)
  - [ ] Defer semantic dialog + focus management changes

### 1.4 Icon Button Labels
**Files:** `src/components/ControlPanel.jsx`, `src/components/GameScene.jsx`

- [x] **Burner control buttons** (‚Üë ‚Üì)
  - [x] Labels present; added descriptive help text

- [x] **Speed control buttons**
  - [x] Added `aria-label` and descriptive help text

- [x] **All icon-only buttons**
  - [x] Added descriptive `aria-label` where needed

### 1.5 Color Contrast Fixes
**Files:** `src/styles/GameScene.css`, `src/styles/App.css`, `src/styles/ControlPanel.css`

**High Priority (critical text):**
- [ ] Header background + text contrast
  - Check current: appears to be dark on light (verify ratio)
  - Target: 4.5:1 for normal text, 3:1 for large text (18pt+)

- [ ] Status label text (temperature display, boiling indicator)
  - [ ] Check white/light text on colored backgrounds
  - [ ] Verify 4.5:1 contrast ratio

- [ ] Warning/error text colors
  - [ ] Yellow on light backgrounds (WCAG fail)
  - [ ] Change to darker color or darker background

**Tools:** Use WebAIM Contrast Checker (webaim.org/resources/contrastchecker/)

---

## üü† PHASE 2: KEYBOARD NAVIGATION &amp; FOCUS (8-10 hours) ‚Äî DEFERRED

Enables full keyboard control of the UI and basic game controls.

### 2.1 Focus Indicators
**Files:** All CSS files (*.css)

- [ ] Add `:focus-visible` styles to all interactive elements
  - [ ] Buttons: add outline or ring effect
  - [ ] Inputs: add outline or shadow
  - [ ] Selects: add outline
  - [ ] Links: add outline
  
Example CSS:
```css
button:focus-visible,
input:focus-visible,
select:focus-visible {
  outline: 3px solid #0066ff;
  outline-offset: 2px;
}
```

- [ ] Test tab order through all controls
  - [ ] Tab key navigates in logical order
  - [ ] Burner controls ‚Üí Speed controls ‚Üí Substance selector ‚Üí Location ‚Üí Reset

### 2.2 Disabled State Accessibility
**Files:** `src/components/ControlPanel.jsx`, `src/components/RoomControls.jsx`

- [ ] **Disabled buttons**
  - [ ] Apply `disabled` attribute when button is unavailable
  - [ ] Add CSS `:disabled` selector with clear visual style
  - [ ] Ensure text contrast remains 4.5:1 when disabled
  
- [ ] **Disabled inputs**
  - [ ] Add `disabled` attribute to locked selectors (before tutorial complete)
  - [ ] Add CSS styling to show disabled state clearly
  - [ ] Add `aria-disabled=&quot;true&quot;` (in addition to disabled attr) if it&#39;s just visually disabled

### 2.3 Keyboard Game Controls (Game Scene)
**Files:** `src/components/GameScene.jsx`

**Goal:** Allow keyboard-only users to play the game.

- [ ] **Pot dragging**
  - [ ] Add keyboard event handler: Arrow keys (‚Üê‚Üí) move pot left/right
  - [ ] `onKeyDown` listener in GameScene
  - [ ] Update pot position based on keypress
  - [ ] Provide visual feedback (focus indicator on draggable area)

- [ ] **Burner control**
  - [ ] +/- keys or W/S keys increase/decrease heat
  - [ ] 0 key = off, 1-9 keys = heat levels
  - [ ] Announce heat level via `aria-live` when changed

- [ ] **Speed control**
  - [ ] [ ] keys decrease/increase speed
  - [ ] Announce speed via `aria-live`

- [ ] **Game scene focus**
  - [ ] Add `role=&quot;application&quot;` to main game container
  - [ ] Add `tabindex=&quot;0&quot;` so it can receive focus
  - [ ] Add instructions: &quot;Press arrow keys to move pot, +/- for heat, [ ] for speed&quot;

### 2.4 Focus Management in Modals
**Files:** `src/components/ControlPanel.jsx`

- [ ] **Location modal**
  - [ ] On open: focus first input in modal
  - [ ] Tab within modal cycles through modal controls only (focus trap)
  - [ ] On close: restore focus to button that opened modal
  - [ ] Escape key closes modal
  
Example implementation pattern:
```jsx
useEffect(() =&gt; {
  if (showLocationPopup) {
    // Focus first input
    document.getElementById(&#39;location-input&#39;).focus()
  }
}, [showLocationPopup])

// In dialog keydown handler:
const handleKeyDown = (e) =&gt; {
  if (e.key === &#39;Escape&#39;) handleLocationClose()
  if (e.key === &#39;Tab&#39;) {
    // Trap focus within modal
    manageFocusWithinModal(e)
  }
}
```

### 2.5 Skip Links
**Files:** `src/components/Header.jsx`, `src/App.jsx`

- [ ] Add &quot;Skip to game&quot; link at very top of page
  - [ ] Hidden by default, visible on focus
  - [ ] Allows keyboard users to bypass header navigation
  - [ ] Link to `&lt;main&gt;` or game container

CSS:
```css
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: #000;
  color: #fff;
  padding: 8px;
  z-index: 100;
}

.skip-link:focus {
  top: 0;
}
```

---

## üü° PHASE 3: SEMANTIC HTML &amp; WCAG LEVEL AA (10-12 hours) ‚Äî DEFERRED

Comprehensive semantic improvements for full WCAG 2.1 Level AA compliance.

### 3.1 Semantic Structure
**Files:** All component JSX files

- [ ] **Status display in ControlPanel**
  - [ ] Convert from DIV+SPAN to `&lt;dl&gt;` (definition list)
  - Example:
    ```jsx
    &lt;dl&gt;
      &lt;dt&gt;Water Temperature:&lt;/dt&gt;
      &lt;dd&gt;{temperature}¬∞C&lt;/dd&gt;
      &lt;dt&gt;Time on Flame:&lt;/dt&gt;
      &lt;dd&gt;{timeOnFlame}s&lt;/dd&gt;
    &lt;/dl&gt;
    ```

- [ ] **Room environment stats** (if displayed)
  - [ ] Use `&lt;dl&gt;` or `&lt;table&gt;` instead of DIVs
  - [ ] If table, add caption: `&lt;caption&gt;Room Environment Status&lt;/caption&gt;`

- [ ] **Heading hierarchy**
  - [ ] Verify all headers use proper `&lt;h1&gt;`, `&lt;h2&gt;`, `&lt;h3&gt;` tags
  - [ ] No skipped levels (e.g., `&lt;h1&gt;` directly to `&lt;h3&gt;`)
  - [ ] Only one `&lt;h1&gt;` per page

### 3.2 ARIA Descriptions &amp; Help Text
**Files:** All component JSX files

- [ ] **Form field help text**
  - [ ] Add `aria-describedby` linking inputs to help text
  - [ ] Example:
    ```jsx
    &lt;label htmlFor=&quot;altitude&quot;&gt;Altitude:&lt;/label&gt;
    &lt;input id=&quot;altitude&quot; aria-describedby=&quot;altitude-help&quot; /&gt;
    &lt;span id=&quot;altitude-help&quot;&gt;Negative = below sea level&lt;/span&gt;
    ```

- [ ] **Control descriptions**
  - [ ] Burner control: &quot;Increase or decrease the heater power from 0 to 5000 watts&quot;
  - [ ] Speed control: &quot;Change simulation speed from 1x to 65536x (pause to normal gameplay)&quot;
  - [ ] Substance selector: &quot;Choose water, ethanol, acetone, ammonia, or saltwater&quot;

- [ ] **Room controls**
  - [ ] AC setpoint: &quot;Set target room temperature from 15¬∞C to 28¬∞C&quot;
  - [ ] Air handler: &quot;Choose filtration mode: off, low, medium, or high&quot;

### 3.3 Error Handling
**Files:** `src/components/ControlPanel.jsx`

- [ ] **Location search errors**
  - [ ] Add `aria-invalid=&quot;true&quot;` to input when error
  - [ ] Link input to error message with `aria-describedby=&quot;error-location&quot;`
  - [ ] Example:
    ```jsx
    &lt;input
      id=&quot;location&quot;
      aria-invalid={hasError}
      aria-describedby=&quot;location-error&quot;
    /&gt;
    {hasError &amp;&amp; &lt;span id=&quot;location-error&quot; role=&quot;alert&quot;&gt;Location not found&lt;/span&gt;}
    ```

- [ ] **Validation messages**
  - [ ] Use `role=&quot;alert&quot;` for error announcements
  - [ ] Screen reader announces error immediately

### 3.4 Image Alt Text
**Files:** `src/components/GameScene.jsx`

- [x] **Pot/Flame/Steam images**
  - [x] Added descriptive `alt` text based on asset usage

- [ ] **Verify all background images**
  - [ ] Check if any are decorative-only (can use alt=&quot;&quot;)
  - [ ] Check if any convey meaning (need proper alt text)

### 3.5 Heading Hierarchy Review
**Files:** All JSX files

- [ ] **Audit current structure**
  - [ ] Note current headings in each file
  - [ ] Identify any skipped levels or duplicate `&lt;h1&gt;`
  
- [ ] **Example audit:**
  - `Header.jsx`: Should have no h1 (header, not main content)
  - `ControlPanel.jsx`: Check for proper nesting if using headings
  - `GameScene.jsx`: If it has headings, verify hierarchy

### 3.6 Table Markup
**Files:** Components that display tabular data

- [ ] **Equipment comparison** (if added later)
  - [ ] Use `&lt;table&gt;`, `&lt;thead&gt;`, `&lt;tbody&gt;`, `&lt;tr&gt;`, `&lt;td&gt;`
  - [ ] Add `&lt;caption&gt;` describing table content
  - [ ] Add `scope=&quot;col&quot;` to header cells

---

## üü¢ PHASE 4: TESTING &amp; EDGE CASES (6-8 hours) ‚Äî DEFERRED

Validation and refinement with actual assistive technologies.

### 4.1 Screen Reader Testing
**Tools:** NVDA (free, Windows), JAWS (paid, most common)

- [ ] **Test with NVDA**
  - [ ] Download NVDA (https://www.nvaccess.org/)
  - [ ] Navigate app with Tab key (follow focus)
  - [ ] Verify all labels are announced
  - [ ] Verify `aria-live` regions are announced
  - [ ] Verify button purposes are clear
  - [ ] Test modal: can focus trap be achieved? Does Escape close it?
  - [ ] Listen for any missing descriptions

- [ ] **Game scene keyboard navigation**
  - [ ] Arrow keys move pot (NVDA announces new position)
  - [ ] +/- keys change heat (announce new level)
  - [ ] Verify game is playable via keyboard only

- [ ] **Form navigation**
  - [ ] Tab through location, altitude, substance selectors
  - [ ] Try entering location ‚Üí Tab to Find button ‚Üí activate
  - [ ] Error message is announced when location not found

### 4.2 Keyboard-Only Testing
**No mouse/touchpad, keyboard only**

- [ ] **Navigation flow**
  - [ ] Home ‚Üí Tab to game scene ‚Üí Arrow keys to move pot ‚Üí OK
  - [ ] Level selector ‚Üí Shift+Tab back to header ‚Üí OK
  - [ ] Speed controls ‚Üí Shift+Tab back to game ‚Üí OK

- [ ] **Modal interaction**
  - [ ] Tab into location input ‚Üí Type city ‚Üí Tab to Search ‚Üí Enter ‚Üí Modal appears
  - [ ] Tab cycles through modal buttons ‚Üí Escape closes ‚Üí Focus returns to button

- [ ] **Game completion**
  - [ ] Play entire experiment (boiling water) with keyboard only
  - [ ] Should be fully functional end-to-end

### 4.3 Lighthouse Accessibility Audit
**Chrome DevTools**

- [ ] Open app in Chrome
- [ ] DevTools ‚Üí Lighthouse ‚Üí Accessibility
- [ ] Run audit
- [ ] Target: Score ‚â• 90 (ideally 95+)
- [ ] Fix any reported issues

### 4.4 Browser Compatibility
**Test across browsers**

- [ ] **Chrome/Edge**
  - [ ] Focus styles visible
  - [ ] Keyboard events work
  - [ ] ARIA attributes recognized

- [ ] **Firefox**
  - [ ] Same checks as Chrome
  - [ ] Focus management works

- [ ] **Safari**
  - [ ] Dialog element supported? (may need polyfill)
  - [ ] aria-modal works?

### 4.5 Edge Cases
**Handle accessibility in specific scenarios**

- [ ] **Tutorial flow**
  - [ ] First-time user with screen reader ‚Üí gets instruction announced
  - [ ] Level unlock ‚Üí announcement &quot;Level 2 unlocked&quot;

- [ ] **Error states**
  - [ ] Invalid altitude input ‚Üí error message announced
  - [ ] Location not found ‚Üí retry available and announced

- [ ] **State transitions**
  - [ ] Water reaches boiling ‚Üí announced loudly (aria-live=&quot;assertive&quot;)
  - [ ] Experiment completes ‚Üí scorecard modal appears with focus trapped

- [ ] **Equipment locked state**
  - [ ] AC controls disabled before L1E4 ‚Üí disabled attribute present
  - [ ] Reason announced via aria-label or aria-describedby

---

## üìä TESTING CHECKLIST

### Before Marking Phase Complete

- [ ] Run `npm run build` ‚Äî no console errors
- [ ] Lighthouse score ‚â• 90 (or all critical issues fixed)
- [ ] axe DevTools scan ‚Äî 0 critical issues, &lt;5 warnings
- [ ] NVDA test ‚Äî app fully navigable and understandable
- [ ] Keyboard-only test ‚Äî can complete tutorial boil
- [ ] Tab order ‚Äî logical and intuitive
- [ ] Color contrast ‚Äî all text ‚â• 4.5:1 (or 3:1 for large)
- [ ] Focus indicators ‚Äî visible on all interactive elements
- [ ] Modal behavior ‚Äî focus trap works, Escape closes

---

## üß∞ TOOLS &amp; RESOURCES

### Browser Extensions
- **axe DevTools** ‚Äî Scan for accessibility violations (free)
- **WAVE** ‚Äî Visual accessibility feedback (free)
- **Lighthouse** ‚Äî Chrome DevTools built-in (free)
- **Color Contrast Analyzer** ‚Äî TPG (free)

### Screen Readers (Testing)
- **NVDA** ‚Äî Free, Windows, excellent (https://www.nvaccess.org/)
- **JAWS** ‚Äî Paid, Windows, industry standard
- **VoiceOver** ‚Äî Built-in, macOS/iOS
- **TalkBack** ‚Äî Built-in, Android

### WCAG References
- **WCAG 2.1** ‚Äî https://www.w3.org/WAI/WCAG21/quickref/
- **WAI-ARIA Practices** ‚Äî https://www.w3.org/WAI/ARIA/apg/
- **MDN: Web Accessibility** ‚Äî https://developer.mozilla.org/en-US/docs/Web/Accessibility

### Example Repos
- **Accessible React** ‚Äî https://github.com/a11y-101/
- **WAI-ARIA Examples** ‚Äî https://www.w3.org/WAI/ARIA/apg/patterns/

---

## üìù NOTES FOR DEVELOPERS

### Key Decisions

1. **Game as Application, Not Document**
   - Game scene uses `role=&quot;application&quot;` because it requires custom keyboard controls (not standard Web controls)
   - This tells screen readers: &quot;User interaction here is non-standard, listen for custom announcements&quot;

2. **ARIA Live vs Alert**
   - `aria-live=&quot;polite&quot;` ‚Äî wait for user to pause, then announce (temperature updates)
   - `aria-live=&quot;assertive&quot;` ‚Äî interrupt immediately (boiling detected!)
   - `role=&quot;alert&quot;` ‚Äî same as assertive, specific for alerts

3. **Focus Trap in Modal**
   - Catch `Tab` key, determine if focus is on last element
   - If so, set focus back to first element (circular trap)
   - Escape key always closes modal

4. **Color Contrast**
   - Normal text: 4.5:1 ratio (WCAG AA)
   - Large text (18pt+): 3:1 ratio (WCAG AA)
   - Graphics/UI: 3:1 ratio (WCAG AA)
   - Use WebAIM Contrast Checker for precise values

5. **Keyboard Shortcuts for Game**
   - Arrow keys: Move pot (discoverable, intuitive)
   - +/‚àí: Adjust heat (secondary labeling clear)
   - [ ]: Adjust speed (less intuitive, but documented)
   - Minimize custom shortcuts; leverage Web standard patterns

---

## üîó DEPENDENCIES

- **No new npm packages required**
- Use built-in React event handlers and HTML APIs
- Use native `&lt;dialog&gt;` element (IE 11 not supported, but acceptable for educational app)
- No third-party a11y libraries needed initially

---

## üìå SUCCESS CRITERIA

**Phase 1 Complete:** 
- All form inputs have labels
- Status updates announced via aria-live
- Modals are semantic dialogs with focus management
- Icon buttons have aria-label
- Color contrast ‚â• 4.5:1 on critical text

**Phase 2 Complete:**
- All buttons/inputs have `:focus-visible` styles
- Tab order is logical
- Game playable via keyboard (arrow keys, +/‚àí, [ ])
- Modals trap focus, Escape closes

**Phase 3 Complete:**
- WCAG 2.1 Level AA compliant
- All semantic HTML in place
- ARIA descriptions linked
- Error handling accessible

**Phase 4 Complete:**
- NVDA fully usable
- Keyboard-only play tested
- Lighthouse score ‚â• 90
- Zero critical axe violations

---

**Estimated Timeline:** 40-50 hours (comprehensive), 6-8 hours (quick wins Phase 1)  
**Team Size:** 1 developer recommended (familiar with codebase)  
**Complexity:** Medium (requires understanding of ARIA, focus management, keyboard events)

</code></pre>
        </details>
      </section>
    
        </article>
      </main>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-jsx.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-tsx.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script>
  <script>
    // Lazy-load Kekule only when molecule viewer is expanded (saves bandwidth on low-end devices)
    (() => {
      let smilesDrawerLoaded = false
      let smilesDrawerLoading = false
      
      // Convert explicit SMILES like [CH3][CH](OH)[CH3] to standard like CC(O)C
      const explicitToStandard = (smiles) => {
        return smiles
          // Common organic groups - order matters (longer patterns first)
          .replace(/\[CH3\]/g, 'C')
          .replace(/\[CH2\]/g, 'C')
          .replace(/\[CH\]/g, 'C')
          .replace(/\[OH\]/g, 'O')
          .replace(/\[NH2\]/g, 'N')
          .replace(/\[NH\]/g, 'N')
          .replace(/\[SH\]/g, 'S')
          // Single atoms in brackets (keep aromatic lowercase)
          .replace(/\[C\]/g, 'C')
          .replace(/\[N\]/g, 'N')
          .replace(/\[O\]/g, 'O')
          .replace(/\[S\]/g, 'S')
          .replace(/\[P\]/g, 'P')
          .replace(/\[F\]/g, 'F')
          .replace(/\[Cl\]/g, 'Cl')
          .replace(/\[Br\]/g, 'Br')
          .replace(/\[I\]/g, 'I')
          // Bare atoms in branches - H is implicit in standard SMILES
          .replace(/\(OH\)/g, '(O)')
          .replace(/\(NH2\)/g, '(N)')
          .replace(/\(NH\)/g, '(N)')
          .replace(/\(SH\)/g, '(S)')
      }
      
      const loadSmilesDrawer = async () => {
        if (smilesDrawerLoaded) return
        if (smilesDrawerLoading) {
          return new Promise(resolve => {
            const check = setInterval(() => {
              if (smilesDrawerLoaded) { clearInterval(check); resolve() }
            }, 50)
          })
        }
        smilesDrawerLoading = true
        
        // Load SmilesDrawer from CDN (much simpler than Kekule)
        await new Promise((resolve, reject) => {
          const script = document.createElement('script')
          script.src = 'https://unpkg.com/smiles-drawer@2.1.7/dist/smiles-drawer.min.js'
          script.onload = resolve
          script.onerror = reject
          document.body.appendChild(script)
        })
        
        smilesDrawerLoaded = true
        smilesDrawerLoading = false
      }
      
      const initMolecule = async (node) => {
        if (node.dataset.initialized) return
        node.dataset.initialized = 'true'
        
        const rawSmiles = node.getAttribute('data-smiles')
        if (!rawSmiles) return
        
        // Convert explicit format to standard if needed
        const smiles = explicitToStandard(rawSmiles)
        
        try {
          await loadSmilesDrawer()
          
          const drawer = new SmilesDrawer.SvgDrawer({ 
            width: 300, 
            height: 200,
            explicitHydrogens: true,
            terminalCarbons: true,
            compactDrawing: false
          })
          
          console.log('Parsing SMILES:', rawSmiles, '->', smiles)
          SmilesDrawer.parse(smiles, (tree) => {
            console.log('Parse success, tree:', tree)
            const svgElement = drawer.draw(tree, null, 'light')
            console.log('SVG element:', svgElement)
            node.innerHTML = ''
            node.appendChild(svgElement)
          }, (err) => {
            console.error('SMILES parse error for "' + smiles + '":', err)
            node.innerHTML = '<code>' + rawSmiles + '</code>'
          })
        } catch (err) {
          console.error('SmilesDrawer load error:', err)
          node.innerHTML = '<code>' + smiles + '</code>'
        }
      }
      
      // Use IntersectionObserver for lazy loading when scrolled into view
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            initMolecule(entry.target)
            observer.unobserve(entry.target)
          }
        })
      }, { rootMargin: '100px' })
      
      // Also handle <details> expansion for molecules inside collapsed sections
      document.addEventListener('toggle', (e) => {
        if (e.target.tagName === 'DETAILS' && e.target.open) {
          const molecules = e.target.querySelectorAll('[data-smiles]:not([data-initialized])')
          molecules.forEach(node => initMolecule(node))
        }
      }, true)
      
      // Observe all molecule nodes
      const init = () => {
        const nodes = document.querySelectorAll('[data-smiles]')
        nodes.forEach(node => observer.observe(node))
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init)
      } else {
        init()
      }
    })()
  </script>
</body>
</html>